<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<TITLE>
Basic4android - ABFTP
</TITLE>
<link rel="stylesheet" type="text/css" href="images/help.css" />

</HEAD>

<BODY BGCOLOR="white" leftmargin="50">
<a name="top"/>
<h1>ABFTP</h1>
<h3>Written by Alain Bailleul</h3>
</h5>
<h4>List of types:</h4>
<a href='#abftp'>ABFTP</a><br/>
<hr/>
<h3><u><a name='abftp'>ABFTP</a></u></h3>

<br/>
<h4>Permissions:</h4>android.permission.INTERNET<br/>
<h4>Events:</h4>
None
<h4>Members:</h4><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#abftp_abftpconnect'><b>ABFTPConnect</b></a> (host </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, port </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">, login </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, pwd </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#abftp_abftpconnected'><b>ABFTPConnected</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#abftp_abftpdeletefile'><b>ABFTPDeleteFile</b></a> (targetFolder </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, targetFile </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#abftp_abftpdisconnect'><b>ABFTPDisconnect</b></a></span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#abftp_abftpdownload'><b>ABFTPDownload</b></a> (sourceFolder </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, sourceFile </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, targetFolder </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, targetFile </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#abftp_abftplasterror'><b>ABFTPLastError</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#abftp_abftplistfiles'><b>ABFTPListFiles</b></a> (listFolder </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">()</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#abftp_abftpupload'><b>ABFTPUpload</b></a> (sourceFolder </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, sourceFile </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, targetFolder </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, targetFile </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>

<h4>Members description:</h4>
<a name='abftp_abftpconnect'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ABFTPConnect (host </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, port </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">, login </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, pwd </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Connects with a ftp site<br/>host (String) : ftp site e.g. ftp.mywebsite.com<br/>port (Int)    : connection port, usually 21<br/>login (String): user login<br/>pwd (String)  : user password<br/>Example:<span class='pre'><span style="color: #000000;"><br/>myFTP.ABFTPConnect(</span><span style="color: #800000;">"</span><span style="color: #800000;">ftp.mywebsite.com</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #800080;">21</span><span style="color: #000000;">, </span><span style="color: #800000;">"</span><span style="color: #800000;">login</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #800000;">"</span><span style="color: #800000;">password</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">If</span><span style="color: #000000;"> myFTP.ABFTPConnected = True </span><span style="color: #0000FF;">Then</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(</span><span style="color: #800000;">"</span><span style="color: #800000;">Connected</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #800000;">""</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">Else</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(myFTP.ABFTPLastError, </span><span style="color: #800000;">""</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">If</span><span style="color: #000000;"><br/></span></span><a name='abftp_abftpconnected'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">ABFTPConnected </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">  [read only]</span></h5>returns if you are connected to the ftp<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">If</span><span style="color: #000000;"> myFTP.ABFTPConnected = True </span><span style="color: #0000FF;">Then</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(</span><span style="color: #800000;">"</span><span style="color: #800000;">Connected</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #800000;">""</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">Else</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(myFTP.ABFTPLastError, </span><span style="color: #800000;">""</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">If</span><span style="color: #000000;"> <br/></span></span><a name='abftp_abftpdeletefile'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ABFTPDeleteFile (targetFolder </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, targetFile </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Deletes a file from the ftp site<br/>targetFolder (String): folder on the ftp site starting and ending with /<br/>targetFile (String)  : file name<br/>Example:<span class='pre'><span style="color: #000000;"><br/>myftp.ABFTPDeleteFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">/upload/</span><span style="color: #800000;">"</span><span style="color: #000000;">,</span><span style="color: #800000;">"</span><span style="color: #800000;">test.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">If</span><span style="color: #000000;"> myftp.ABFTPLastError &lt;&gt; </span><span style="color: #800000;">""</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Then</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(myftp.ABFTPLastError,</span><span style="color: #800000;">""</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">Else</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(</span><span style="color: #800000;">"</span><span style="color: #800000;">file deleted!</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #800000;">""</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">If</span><span style="color: #000000;"><br/></span></span><a name='abftp_abftpdisconnect'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ABFTPDisconnect</span></h5>Disconnects from the ftp<br/>Example:<span class='pre'><span style="color: #000000;"><br/>myftp.ABFTPDisconnect()<br/></span></span><a name='abftp_abftpdownload'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ABFTPDownload (sourceFolder </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, sourceFile </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, targetFolder </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, targetFile </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Downloads a file from the ftp to the device<br/>sourceFolder (String): folder on the ftp starting and ending with /<br/>sourceFile (String)  : filename on the ftp<br/>targetFolder (String): folder on the device starting and ending with /<br/>targetFile (String)  : filename on the device<br/>Example:<span class='pre'><span style="color: #000000;"><br/>sdRoot = File.DirRootExternal &amp; </span><span style="color: #800000;">"</span><span style="color: #800000;">/</span><span style="color: #800000;">"</span><span style="color: #000000;"><br/>myftp.ABFTPDownload(</span><span style="color: #800000;">"</span><span style="color: #800000;">/upload/</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #800000;">"</span><span style="color: #800000;">test.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">, sdRoot, </span><span style="color: #800000;">"</span><span style="color: #800000;">test2.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">If</span><span style="color: #000000;"> myftp.ABFTPLastError &lt;&gt; </span><span style="color: #800000;">""</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Then</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(myftp.ABFTPLastError,</span><span style="color: #800000;">""</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">Else</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(</span><span style="color: #800000;">"</span><span style="color: #800000;">File downloaded!, "")</span><span style="color: #800000;"><br/></span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">If</span><span style="color: #000000;"><br/></span></span><a name='abftp_abftplasterror'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">ABFTPLastError </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">  [read only]</span></h5>returns the last error message if any<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">If</span><span style="color: #000000;"> myftp.ABFTPLastError &lt;&gt; </span><span style="color: #800000;">""</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Then</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(myftp.ABFTPLastError,</span><span style="color: #800000;">""</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">Else</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(</span><span style="color: #800000;">"</span><span style="color: #800000;">everything ok</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #800000;">""</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">If</span><span style="color: #000000;"> <br/></span></span><a name='abftp_abftplistfiles'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ABFTPListFiles (listFolder </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">()</span></h5>Returns a table of strings with the file names<br/>listFolder (String): the folder to list<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> myFiles() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;"><br/>myfiles = myftp.ABFTPListFiles(</span><span style="color: #800000;">"</span><span style="color: #800000;">/upload/</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">If</span><span style="color: #000000;"> myftp.ABFTPLastError &lt;&gt; </span><span style="color: #800000;">""</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Then</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(myftp.ABFTPLastError,</span><span style="color: #800000;">""</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">Else</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">For</span><span style="color: #000000;"> a = </span><span style="color: #800080;">0</span><span style="color: #000000;"> </span><span style="color: #0000FF;">To</span><span style="color: #000000;"> myfiles.Length - </span><span style="color: #800080;">1</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listview1.AddSingleLine(myfiles(a))<br/>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">Next</span><span style="color: #000000;"><br/></span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">If</span><span style="color: #000000;"><br/></span></span><a name='abftp_abftpupload'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ABFTPUpload (sourceFolder </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, sourceFile </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, targetFolder </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, targetFile </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Uploads a file from the device to the ftp<br/>sourceFolder (String): folder on the device starting and ending with /<br/>sourceFile (String)  : filename on the device<br/>targetFolder (String): folder on the ftp starting and ending with /<br/>targetFile (String)  : filename on the ftp<br/>Example:<span class='pre'><span style="color: #000000;"><br/>sdRoot = File.DirRootExternal &amp; </span><span style="color: #800000;">"</span><span style="color: #800000;">/</span><span style="color: #800000;">"</span><span style="color: #000000;"><br/>myftp.ABFTPUpload(sdRoot, </span><span style="color: #800000;">"</span><span style="color: #800000;">test.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">,</span><span style="color: #800000;">"</span><span style="color: #800000;">upload</span><span style="color: #800000;">"</span><span style="color: #000000;">,</span><span style="color: #800000;">"</span><span style="color: #800000;">test.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">If</span><span style="color: #000000;"> myftp.ABFTPLastError &lt;&gt; </span><span style="color: #800000;">""</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Then</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(myftp.ABFTPLastError,</span><span style="color: #800000;">""</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">Else</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(</span><span style="color: #800000;">"</span><span style="color: #800000;">file uploaded!</span><span style="color: #800000;">"</span><span style="color: #000000;">,</span><span style="color: #800000;">""</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">If</span><span style="color: #000000;"><br/></span></span>
<hr/>
<a href="#top">Top</a>
</body>
</html>
