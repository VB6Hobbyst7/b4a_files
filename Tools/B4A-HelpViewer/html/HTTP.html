<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<TITLE>
Basic4android - HTTP
</TITLE>
<link rel="stylesheet" type="text/css" href="images/help.css" />

</HEAD>

<BODY BGCOLOR="white" leftmargin="50">
<a name="top"/>
<h1>HTTP</h1>

</h5>The HTTP library allows you to communicate with web services and to download resources from the web.<br/>As network communication can be slow and fragile this library handles the requests and responses in the background and raises events when a task is ready.<br/>There are two HTTP examples which demonstrate this library: <a href='http://www.basic4ppc.com/forum/basic4android-getting-started-tutorials/6506-currency-converter-http-web-services-more.html'>Currency Converter</a> and a more complex example: <a href='http://www.basic4ppc.com/forum/basic4android-getting-started-tutorials/6646-flickr-viewer.html'>Flickr Viewer</a>.
<h4>List of types:</h4>
<a href='#httpclient'>HttpClient</a><br/><a href='#httprequest'>HttpRequest</a><br/><a href='#httpresponse'>HttpResponse</a><br/>
<hr/>
<h3><u><a name='httpclient'>HttpClient</a></u></h3>
</h5>The main object. This object can manage multiple tasks concurrently. <b>It is very important to declare it as a process global variable (under Sub Process_Globals)</b>.
<br/>
<h4>Permissions:</h4>android.permission.INTERNET<br/>
<h4>Events:</h4>
ResponseSuccess (Response As HttpResponse, TaskId As Int)<br/>ResponseError (Response As HttpResponse, Reason As String, StatusCode As Int, TaskId As Int)<br/>
<h4>Members:</h4><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpclient_execute'><b>Execute</b></a> (HttpRequest </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> HttpRequest, TaskId </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpclient_executecredentials'><b>ExecuteCredentials</b></a> (HttpRequest </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> HttpRequest, TaskId </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">, UserName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Password </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpclient_initialize'><b>Initialize</b></a> (EventName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpclient_initializeacceptall'><b>InitializeAcceptAll</b></a> (EventName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpclient_sethttpparameter'><b>SetHttpParameter</b></a> (Name </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Value </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Object</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpclient_setproxy'><b>SetProxy</b></a> (Host </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Port </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">, Scheme </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>

<h4>Members description:</h4>
<a name='httpclient_execute'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Execute (HttpRequest </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> HttpRequest, TaskId </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span></h5>Executes the HttpRequest asynchronously. ResponseSuccess or ResponseError events will be fired later.<br/>Note that in many cases the Response object passed in ResponseError event will be Null.<br/>If there is a request with the same TaskId already running then this method will return False and the new request will not be submitted.<a name='httpclient_executecredentials'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ExecuteCredentials (HttpRequest </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> HttpRequest, TaskId </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">, UserName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Password </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span></h5>Same behavior as Execute. The UserName and Password will be used for Basic or Digest authentication.<br/>Digest authentication is only supported for GET requests.<a name='httpclient_initialize'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Initialize (EventName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Initializes this object.<br/>IMPORTANT: this object should be declared in Sub Process_Globals.<br/>EventName - The prefix that will be used for ResponseSuccess and ResponseError events.<a name='httpclient_initializeacceptall'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">InitializeAcceptAll (EventName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Similar to Initialize, with one important difference. All SSL certificates will be automatically accepted.<br/><b>This method should only be used when trying to connect to a server located in a secured network</b>.<a name='httpclient_sethttpparameter'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">SetHttpParameter (Name </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Value </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Object</span><span style="color: #000000;">)</span></h5>Sets the value of the parameter with the given name.<a name='httpclient_setproxy'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">SetProxy (Host </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Port </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">, Scheme </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Sets the proxy to use for the connections.<br/>Host - Proxy host name or IP.<br/>Port - Proxy port.<br/>Scheme - Scheme name. Usually "http".<hr/>
<h3><u><a name='httprequest'>HttpRequest</a></u></h3>
</h5>Holds the target URL and other data sent to the web server.<br/>The initial time out is to 30000 milliseconds (30 seconds).
<br/>

<h4>Events:</h4>
None
<h4>Members:</h4><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httprequest_initializeget'><b>InitializeGet</b></a> (URL </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httprequest_initializepost'><b>InitializePost</b></a> (URL </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, </span><span style="color: #008B8B;">InputStream</span><span style="color: #000000;"> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> java.io.InputStream, Length </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httprequest_initializepost2'><b>InitializePost2</b></a> (URL </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Data() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Byte</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httprequest_removeheaders'><b>RemoveHeaders</b></a> (Name </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httprequest_setcontentencoding'><b>SetContentEncoding</b></a> (Encoding </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httprequest_setcontenttype'><b>SetContentType</b></a> (ContentType </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httprequest_setheader'><b>SetHeader</b></a> (Name </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Value </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httprequest_timeout'><b>Timeout</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [write only]</span><br/><br/>

<h4>Members description:</h4>
<a name='httprequest_initializeget'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">InitializeGet (URL </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Initializes the request and sets it to be a Http Get method.<a name='httprequest_initializepost'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">InitializePost (URL </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, </span><span style="color: #008B8B;">InputStream</span><span style="color: #000000;"> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> java.io.InputStream, Length </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">)</span></h5>Initializes the request and sets it to be a Http Post method.<br/>The specified InputStream will be read and added to the request.<a name='httprequest_initializepost2'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">InitializePost2 (URL </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Data() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Byte</span><span style="color: #000000;">)</span></h5>Initializes the request and sets it to be a Http Post method.<br/>The specified Data array will be added to the request.<br/>Unlike InitializePost this method will enable the request to retry and send the data several times in case of IO errors.<a name='httprequest_removeheaders'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">RemoveHeaders (Name </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Removes all headers with the given name.<a name='httprequest_setcontentencoding'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">SetContentEncoding (Encoding </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Sets the encoding header of the request.<br/>This method should only be used with Post requests.<a name='httprequest_setcontenttype'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">SetContentType (ContentType </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Sets the Mime header of the request.<br/>This method should only be used with Post requests.<a name='httprequest_setheader'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">SetHeader (Name </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Value </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Sets the value of the first header with the given name. If no such header exists then a new header will be added.<a name='httprequest_timeout'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">Timeout </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [write only]</span></h5>Sets the request timeout measures in milliseconds.<hr/>
<h3><u><a name='httpresponse'>HttpResponse</a></u></h3>
</h5>An object that holds the response returned from the server.<br/>The object is passed in the ResponseSuccess event.<br/>You can choose to read the response synchronously or asynchronously.<br/>It is important to release this object when it is not used anymore by calling Release.
<br/>

<h4>Events:</h4>
StreamFinish (Success As Boolean, TaskId As Int)<br/>
<h4>Members:</h4><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpresponse_contentencoding'><b>ContentEncoding</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpresponse_contentlength'><b>ContentLength</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Long</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpresponse_contenttype'><b>ContentType</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpresponse_getasynchronously'><b>GetAsynchronously</b></a> (EventName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Output </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> java.io.OutputStream, CloseOutput </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">, TaskId </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpresponse_getheaders'><b>GetHeaders</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Map</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpresponse_getinputstream'><b>GetInputStream</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> InputStreamWrapper</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpresponse_getstring'><b>GetString</b></a> (DefaultCharset </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpresponse_release'><b>Release</b></a></span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#httpresponse_statuscode'><b>StatusCode</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span><br/><br/>

<h4>Members description:</h4>
<a name='httpresponse_contentencoding'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">ContentEncoding </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">  [read only]</span></h5>Returns the content encoding header.<a name='httpresponse_contentlength'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">ContentLength </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Long</span><span style="color: #000000;">  [read only]</span></h5>Returns the content length header.<a name='httpresponse_contenttype'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">ContentType </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">  [read only]</span></h5>Returns the content type header.<a name='httpresponse_getasynchronously'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetAsynchronously (EventName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Output </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> java.io.OutputStream, CloseOutput </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">, TaskId </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span></h5>Asynchronously reads the response and writes it to the given OutputStream.<br/>If there is a request with the same TaskId already running then this method will return False, and the response object will be released.<br/>The StreamFinish event will be raised after the response has been fully read.<br/>EventName - The sub that will handle the StreamFinish event.<br/>Output - The stream from the server will be written to this stream.<br/>CloseOutput - Whether to close the specified output stream when done.<br/>TaskId - The task id given to this task.<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">Sub </span><span style="color: #000000;">Http_ResponseSuccess (Response </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> HttpResponse, TaskId </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">)<br/>&nbsp;&nbsp;&nbsp;&nbsp;Response.GetAsynchronously(</span><span style="color: #800000;">"</span><span style="color: #800000;">ImageResponse</span><span style="color: #800000;">"</span><span style="color: #000000;">, _ <br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File.OpenOutput(File.DirInternalCache, </span><span style="color: #800000;">"</span><span style="color: #800000;">image.jpg</span><span style="color: #800000;">"</span><span style="color: #000000;">, False), True, TaskId)<br/></span><span style="color: #0000FF;">End Sub</span><span style="color: #000000;"><br/><br/></span><span style="color: #0000FF;">Sub </span><span style="color: #000000;">ImageResponse_StreamFinish (Success </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">, TaskId </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">)<br/>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">If</span><span style="color: #000000;"> Success = False </span><span style="color: #0000FF;">Then</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Msgbox(LastException.Message, </span><span style="color: #800000;">"</span><span style="color: #800000;">Error</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">Return</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">If</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;ImageView1.Bitmap = LoadBitmap(File.DirInternalCache, </span><span style="color: #800000;">"</span><span style="color: #800000;">image.jpg</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">End Sub</span></span><a name='httpresponse_getheaders'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetHeaders </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Map</span></h5>Returns a Map object with the response headers.<br/>Each elements is made of a key which is the header name and a value which is a list containing the values (one or more).<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> list1 </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">List</span><span style="color: #000000;"><br/>list1 = response.GetHeaders.Get(</span><span style="color: #800000;">"</span><span style="color: #800000;">Set-Cookie</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">For</span><span style="color: #000000;"> i = </span><span style="color: #800080;">0</span><span style="color: #000000;"> </span><span style="color: #0000FF;">To</span><span style="color: #000000;"> list1.Size - </span><span style="color: #800080;">1</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Log(list1.Get(i))<br/></span><span style="color: #0000FF;">Next</span></span><a name='httpresponse_getinputstream'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetInputStream </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> InputStreamWrapper</span></h5>Returns the InputStream that you can use to read the response.<a name='httpresponse_getstring'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetString (DefaultCharset </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span></h5>Reads the response and returns it as a string.<br/>The specified encoding will be used if the response did not define it explicitly.<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;"><br/>result = HttpResponse1.GetString(</span><span style="color: #800000;">"</span><span style="color: #800000;">UTF8</span><span style="color: #800000;">"</span><span style="color: #000000;">)</span></span><a name='httpresponse_release'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Release</span></h5>Frees resources allocated for this object.<a name='httpresponse_statuscode'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">StatusCode </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span></h5>Returns the response Http code.
<hr/>
<a href="#top">Top</a>
</body>
</html>
