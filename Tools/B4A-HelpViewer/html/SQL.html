<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<TITLE>
Basic4android - SQL
</TITLE>
<link rel="stylesheet" type="text/css" href="images/help.css" />

</HEAD>

<BODY BGCOLOR="white" leftmargin="50">
<a name="top"/>
<h1>SQL</h1>

</h5>The SQL library allows you to create and manage SQL databases.<br/>See the <a href='http://www.basic4ppc.com/forum/basic4android-getting-started-tutorials/6736-sql-tutorial.html'>SQL tutorial</a> for more information.
<h4>List of types:</h4>
<a href='#cursor'>Cursor</a><br/><a href='#sql'>SQL</a><br/>
<hr/>
<h3><u><a name='cursor'>Cursor</a></u></h3>

<br/>

<h4>Events:</h4>
None
<h4>Members:</h4><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_close'><b>Close</b></a></span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_columncount'><b>ColumnCount</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_getblob'><b>GetBlob</b></a> (ColumnName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Byte</span><span style="color: #000000;">()</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_getblob2'><b>GetBlob2</b></a> (Index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Byte</span><span style="color: #000000;">()</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_getdouble'><b>GetDouble</b></a> (ColumnName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Double</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_getdouble2'><b>GetDouble2</b></a> (Index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Double</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_getint'><b>GetInt</b></a> (ColumnName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_getint2'><b>GetInt2</b></a> (Index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_getlong'><b>GetLong</b></a> (ColumnName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Long</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_getlong2'><b>GetLong2</b></a> (Index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Long</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_getstring'><b>GetString</b></a> (ColumnName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_getstring2'><b>GetString2</b></a> (Index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_isinitialized'><b>IsInitialized</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_position'><b>Position</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#cursor_rowcount'><b>RowCount</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span><br/><br/>

<h4>Members description:</h4>
<a name='cursor_close'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Close</span></h5>Closes the cursor and frees resources.<a name='cursor_columncount'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">ColumnCount </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span></h5>Gets the number of columns available in the result set.<a name='cursor_getblob'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetBlob (ColumnName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Byte</span><span style="color: #000000;">()</span></h5>Returns the blob stored in the given column.<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> Buffer() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Byte</span><span style="color: #000000;"><br/>Buffer = Cursor.GetBlob(</span><span style="color: #800000;">"</span><span style="color: #800000;">col1</span><span style="color: #800000;">"</span><span style="color: #000000;">)</span></span><a name='cursor_getblob2'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetBlob2 (Index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Byte</span><span style="color: #000000;">()</span></h5>Returns the blob stored in the column at the given ordinal.<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> Buffer() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Byte</span><span style="color: #000000;"><br/>Buffer = Cursor.GetBlob2(</span><span style="color: #800080;">0</span><span style="color: #000000;">)</span></span><a name='cursor_getdouble'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetDouble (ColumnName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Double</span></h5>Returns the Double value stored in the given column.<br/>The value will be converted to Double if it is of different type.<br/>Example:<span class='pre'><span style="color: #000000;"><br/>Log(Cursor.GetDouble(</span><span style="color: #800000;">"</span><span style="color: #800000;">col2</span><span style="color: #800000;">"</span><span style="color: #000000;">))</span></span><a name='cursor_getdouble2'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetDouble2 (Index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Double</span></h5>Returns the Double value stored in the column at the given ordinal.<br/>The value will be converted to Double if it is of different type.<br/>Example:<span class='pre'><span style="color: #000000;"><br/>Log(Cursor.GetDouble2(</span><span style="color: #800080;">0</span><span style="color: #000000;">))</span></span><a name='cursor_getint'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetInt (ColumnName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span></h5>Returns the Int value stored in the given column.<br/>The value will be converted to Int if it is of different type.<br/>Example:<span class='pre'><span style="color: #000000;"><br/>Log(Cursor.GetInt(</span><span style="color: #800000;">"</span><span style="color: #800000;">col2</span><span style="color: #800000;">"</span><span style="color: #000000;">))</span></span><a name='cursor_getint2'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetInt2 (Index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span></h5>Returns the Int value stored in the column at the given ordinal.<br/>The value will be converted to Int if it is of different type.<br/>Example:<span class='pre'><span style="color: #000000;"><br/>Log(Cursor.GetInt2(</span><span style="color: #800080;">0</span><span style="color: #000000;">))</span></span><a name='cursor_getlong'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetLong (ColumnName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Long</span></h5>Returns the Long value stored in the given column.<br/>The value will be converted to Long if it is of different type.<br/>Example:<span class='pre'><span style="color: #000000;"><br/>Log(Cursor.GetLong(</span><span style="color: #800000;">"</span><span style="color: #800000;">col2</span><span style="color: #800000;">"</span><span style="color: #000000;">))</span></span><a name='cursor_getlong2'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetLong2 (Index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Long</span></h5>Returns the Long value stored in the column at the given ordinal.<br/>The value will be converted to Long if it is of different type.<br/>Example:<span class='pre'><span style="color: #000000;"><br/>Log(Cursor.GetLong2(</span><span style="color: #800080;">0</span><span style="color: #000000;">))</span></span><a name='cursor_getstring'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetString (ColumnName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span></h5>Returns the String value stored in the given column.<br/>The value will be converted to String if it is of different type.<br/>Example:<span class='pre'><span style="color: #000000;"><br/>Log(Cursor.GetString(</span><span style="color: #800000;">"</span><span style="color: #800000;">col2</span><span style="color: #800000;">"</span><span style="color: #000000;">))</span></span><a name='cursor_getstring2'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">GetString2 (Index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span></h5>Returns the String value stored in the column at the given ordinal.<br/>The value will be converted to String if it is of different type.<br/>Example:<span class='pre'><span style="color: #000000;"><br/>Log(Cursor.GetString2(</span><span style="color: #800080;">0</span><span style="color: #000000;">))</span></span><a name='cursor_isinitialized'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">IsInitialized </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span></h5><a name='cursor_position'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">Position </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span></h5>Gets or sets the current position (row).<br/>Note that the starting position of a cursor returned from a query is -1.<br/>The first valid position is 0.<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> Cursor </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Cursor<br/>Cursor = SQL1.ExecQuery(</span><span style="color: #800000;">"</span><span style="color: #800000;">SELECT col1, col2 FROM table1</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">For</span><span style="color: #000000;"> i = </span><span style="color: #800080;">0</span><span style="color: #000000;"> </span><span style="color: #0000FF;">To</span><span style="color: #000000;"> Cursor.RowCount - </span><span style="color: #800080;">1</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Cursor.Position = i<br/>&nbsp;&nbsp;&nbsp;&nbsp;Log(Cursor.GetString(</span><span style="color: #800000;">"</span><span style="color: #800000;">col1</span><span style="color: #800000;">"</span><span style="color: #000000;">))<br/>&nbsp;&nbsp;&nbsp;&nbsp;Log(Cursor.GetInt(</span><span style="color: #800000;">"</span><span style="color: #800000;">col2</span><span style="color: #800000;">"</span><span style="color: #000000;">))<br/></span><span style="color: #0000FF;">Next</span><span style="color: #000000;"><br/>Cursor.Close</span></span><a name='cursor_rowcount'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">RowCount </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span></h5>Gets the numbers or rows available in the result set.<hr/>
<h3><u><a name='sql'>SQL</a></u></h3>
</h5>The main object that accesses the database.
<br/>

<h4>Events:</h4>
None
<h4>Members:</h4><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#sql_begintransaction'><b>BeginTransaction</b></a></span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#sql_close'><b>Close</b></a></span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#sql_endtransaction'><b>EndTransaction</b></a></span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#sql_execnonquery'><b>ExecNonQuery</b></a> (Statement </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#sql_execnonquery2'><b>ExecNonQuery2</b></a> (Statement </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Args </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">List</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#sql_execquery'><b>ExecQuery</b></a> (Query </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> android.database.Cursor</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#sql_execquery2'><b>ExecQuery2</b></a> (Query </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, StringArgs() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> android.database.Cursor</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#sql_execquerysingleresult'><b>ExecQuerySingleResult</b></a> (Query </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#sql_execquerysingleresult2'><b>ExecQuerySingleResult2</b></a> (Query </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, StringArgs() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#sql_initialize'><b>Initialize</b></a> (Dir </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, FileName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, CreateIfNecessary </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#sql_isinitialized'><b>IsInitialized</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#sql_transactionsuccessful'><b>TransactionSuccessful</b></a></span><br/><br/>

<h4>Members description:</h4>
<a name='sql_begintransaction'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">BeginTransaction</span></h5>Begins a transaction. A transaction is a set of multiple "writing" statements that are atomically committed,<br/>hence all changes will be made or no changes will be made.<br/>As a side effect those statements will be executed significantly faster (in the default case a transaction is implicitly created for<br/>each statement).<br/>It is very important to handle transaction carefully and close them.<br/>The transaction is considered successful only if TransactionSuccessful is called. Otherwise no changes will be made.<br/>Typical usage:<span class='pre'><span style="color: #000000;"><br/>SQL1.BeginTransaction<br/></span><span style="color: #0000FF;">Try</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000;">'</span><span style="color: #008000;">block of statements like:</span><span style="color: #008000;"><br/></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">For</span><span style="color: #000000;"> i = </span><span style="color: #800080;">1</span><span style="color: #000000;"> </span><span style="color: #0000FF;">to</span><span style="color: #000000;"> </span><span style="color: #800080;">1000</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL1.ExecNonQuery(</span><span style="color: #800000;">"</span><span style="color: #800000;">INSERT INTO table1 VALUES(...)</span><span style="color: #800000;"><br/></span><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF;">Next</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;SQL1.TransactionSuccessful<br/></span><span style="color: #0000FF;">Catch</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Log(LastException.Message) </span><span style="color: #008000;">'</span><span style="color: #008000;">no changes will be made</span><span style="color: #008000;"><br/></span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;"><br/>SQL1.EndTransaction</span></span><a name='sql_close'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Close</span></h5>Closes the database.<br/>Does not do anything if the database is not opened or was closed before.<a name='sql_endtransaction'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">EndTransaction</span></h5>Ends the transaction.<a name='sql_execnonquery'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ExecNonQuery (Statement </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Executes a single non query SQL statement.<br/>Example:<span class='pre'><span style="color: #000000;"><br/>SQL1.ExecNonQuery(</span><span style="color: #800000;">"</span><span style="color: #800000;">CREATE TABLE table1 (col1 TEXT , col2 INTEGER, col3 INTEGER)</span><span style="color: #800000;">"</span><span style="color: #000000;">)</span></span><br/>If you plan to do many "writing" queries one after another, then you should consider using BeginTransaction / EndTransaction.<br/>It will execute significantly faster.<a name='sql_execnonquery2'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ExecNonQuery2 (Statement </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, Args </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">List</span><span style="color: #000000;">)</span></h5>Executes a single non query SQL statement.<br/>The statement can include question marks which will be replaced by the items in the given list.<br/>Note that Basic4android converts arrays to lists implicitly.<br/>The values in the list should be strings, numbers or bytes arrays.<br/>Example:<span class='pre'><span style="color: #000000;"><br/>SQL1.ExecNonQuery2(</span><span style="color: #800000;">"</span><span style="color: #800000;">INSERT INTO table1 VALUES (?, ?, 0)</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #0000FF;">Array</span><span style="color: #000000;"> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Object</span><span style="color: #000000;">(</span><span style="color: #800000;">"</span><span style="color: #800000;">some text</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #800080;">2</span><span style="color: #000000;">))</span></span><a name='sql_execquery'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ExecQuery (Query </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> android.database.Cursor</span></h5>Executes the query and returns a cursor which is used to go over the results.<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> Cursor </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Cursor<br/>Cursor = SQL1.ExecQuery(</span><span style="color: #800000;">"</span><span style="color: #800000;">SELECT col1, col2 FROM table1</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br/></span><span style="color: #0000FF;">For</span><span style="color: #000000;"> i = </span><span style="color: #800080;">0</span><span style="color: #000000;"> </span><span style="color: #0000FF;">To</span><span style="color: #000000;"> Cursor.RowCount - </span><span style="color: #800080;">1</span><span style="color: #000000;"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Cursor.Position = i<br/>&nbsp;&nbsp;&nbsp;&nbsp;Log(Cursor.GetString(</span><span style="color: #800000;">"</span><span style="color: #800000;">col1</span><span style="color: #800000;">"</span><span style="color: #000000;">))<br/>&nbsp;&nbsp;&nbsp;&nbsp;Log(Cursor.GetInt(</span><span style="color: #800000;">"</span><span style="color: #800000;">col2</span><span style="color: #800000;">"</span><span style="color: #000000;">))<br/></span><span style="color: #0000FF;">Next</span></span><a name='sql_execquery2'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ExecQuery2 (Query </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, StringArgs() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> android.database.Cursor</span></h5>Executes the query and returns a cursor which is used to go over the results.<br/>The query can include question marks which will be replaced with the values in the array.<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> Cursor </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Cursor<br/>Cursor = sql1.ExecQuery2(</span><span style="color: #800000;">"</span><span style="color: #800000;">SELECT col1 FROM table1 WHERE col3 = ?</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #0000FF;">Array</span><span style="color: #000000;"> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">(</span><span style="color: #800080;">22</span><span style="color: #000000;">))</span></span><br/>SQLite will try to convert the string values based on the columns types.<a name='sql_execquerysingleresult'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ExecQuerySingleResult (Query </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span></h5>Executes the query and returns the value in the first column and the first row (in the result set).<br/>Returns Null if no results were found.<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> NumberOfMatches </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;"><br/>NumberOfMatches = SQL1.ExecQuerySingleResult(</span><span style="color: #800000;">"</span><span style="color: #800000;">SELECT count(*) FROM table1 WHERE col2 &gt; 300</span><span style="color: #800000;">"</span><span style="color: #000000;">)</span></span><a name='sql_execquerysingleresult2'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ExecQuerySingleResult2 (Query </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, StringArgs() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span></h5>Executes the query and returns the value in the first column and the first row (in the result set).<br/>Returns Null if no results were found.<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> NumberOfMatches </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;"><br/>NumberOfMatches = SQL1.ExecQuerySingleResult2(</span><span style="color: #800000;">"</span><span style="color: #800000;">SELECT count(*) FROM table1 WHERE col2 &gt; ?</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #0000FF;">Array</span><span style="color: #000000;"> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">(</span><span style="color: #800080;">300</span><span style="color: #000000;">))</span></span><a name='sql_initialize'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Initialize (Dir </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, FileName </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, CreateIfNecessary </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">)</span></h5>Opens the database file. A new database will be created if it does not exist and CreateIfNecessary is true.<br/>IMPORTANT: this object should be declared in Sub Process_Globals.<br/>Example:<span class='pre'><span style="color: #000000;"><br/></span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> SQL1 </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> SQL<br/>SQL1.Initialize(File.InternalDir, </span><span style="color: #800000;">"</span><span style="color: #800000;">MyDb.db</span><span style="color: #800000;">"</span><span style="color: #000000;">, True)</span></span><a name='sql_isinitialized'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">IsInitialized </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span></h5>Tests whether the database is initialized and opened.<a name='sql_transactionsuccessful'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">TransactionSuccessful</span></h5>Marks the transaction as a successful transaction. No further statements should be executed till calling EndTransaction.
<hr/>
<a href="#top">Top</a>
</body>
</html>
