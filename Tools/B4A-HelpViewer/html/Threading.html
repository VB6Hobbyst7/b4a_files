<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<TITLE>
Basic4android - Threading
</TITLE>
<link rel="stylesheet" type="text/css" href="images/help.css" />

</HEAD>

<BODY BGCOLOR="white" leftmargin="50">
<a name="top"/>
<h1>Threading</h1>

</h5>Basic4Android applications have only one thread, the main or GUI (Graphical User Interface)<br/>thread that, not surprisingly, handles the user interface (and everything else).<br/>Using this library you can create additional threads that operate (apparently)<br/>in parallel alongside each other and the GUI thread. Threads can be useful to keep<br/>the user interface alive while performing a long sequence of computations or while<br/>waiting for something to happen.<br/><br/>Such threads are not allowed to manipulate GUI elements directly but this can be<br/>achieved by the Thread.RunOnGuiThread method that runs a Sub on the main GUI thread.<br/><br/>This library contains a Thread object that runs the Basic4Android Sub on a separate<br/>thread, a Lock object to facilite orderly use of resources by different threads and<br/>can also be used to synchronise threads and an Exception object to give more<br/>flexibility in handling exceptions than is native to Basic4Android.
<h4>List of types:</h4>
<a href='#exceptionex'>ExceptionEx</a><br/><a href='#lock'>Lock</a><br/><a href='#thread'>Thread</a><br/>
<hr/>
<h3><u><a name='exceptionex'>ExceptionEx</a></u></h3>
</h5>This is the Exception object that provides facilites for handling exceptions.<br/>As Basic4Android has a more basic Exception object this one is called ExceptionEx<br/>to avoid a name conflict.
<br/>

<h4>Events:</h4>
None
<h4>Members:</h4><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_cause'><b>Cause</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Exception</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_initialize'><b>Initialize</b></a> (message </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_isinitialized'><b>IsInitialized</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_message'><b>Message</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_name'><b>Name</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_stacktrace'><b>StackTrace</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_stacktraceelement'><b>StackTraceElement</b></a> (index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_stacktraceelementfile'><b>StackTraceElementFile</b></a> (index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_stacktraceelementline'><b>StackTraceElementLine</b></a> (index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_stacktraceelementmethod'><b>StackTraceElementMethod</b></a> (index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_stacktracelength'><b>StackTraceLength</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_throw'><b>Throw</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_tostring'><b>ToString</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#exceptionex_version'><b>Version</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Double</span><span style="color: #000000;">  [read only]</span><br/><br/>

<h4>Members description:</h4>
<a name='exceptionex_cause'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">Cause </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Exception</span><span style="color: #000000;">  [read only]</span></h5>Returns the cause of this Exception, or Null if there is no cause.<a name='exceptionex_initialize'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Initialize (message </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Constructs a new ExceptionEx with the current stack trace and<br/>the specified message.<a name='exceptionex_isinitialized'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">IsInitialized </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span></h5><a name='exceptionex_message'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">Message </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">  [read only]</span></h5>Returns the information message which was provided when this<br/>Exception was created. Returns null if no message was provided at<br/>creation time.<a name='exceptionex_name'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">Name </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">  [read only]</span></h5>Returns the name of the class of this Exception which identifies<br/>the type of the Exception.<a name='exceptionex_stacktrace'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">StackTrace </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">  [read only]</span></h5>Returns a string containing the entire stack trace for this Exception.<a name='exceptionex_stacktraceelement'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">StackTraceElement (index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span></h5>Returns a string describing the stack trace element at position<br/>index in the stack trace for this Exception. Index 0 is the one<br/>at the top of the stack and identifies the method and line number<br/>in the Java source code at which this Exception was thrown.<a name='exceptionex_stacktraceelementfile'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">StackTraceElementFile (index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span></h5>Returns the name of the Java source file containing the method belonging<br/>to this StackTraceElement.<a name='exceptionex_stacktraceelementline'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">StackTraceElementLine (index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span></h5>Returns the line number in the Java source for the method belonging<br/>to this StackTraceElement. Only useful for the gurus amongst us!<a name='exceptionex_stacktraceelementmethod'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">StackTraceElementMethod (index </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span></h5>Returns the name of the method belonging to this StackTraceElement.<a name='exceptionex_stacktracelength'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">StackTraceLength </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span></h5>Returns the number of stack trace entries in the stack trace for<br/>this Exception.<a name='exceptionex_throw'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Throw </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span></h5>Throws this Exception.<a name='exceptionex_tostring'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">ToString </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span></h5>Returns a string containing both the name of this Exception and the<br/>message, if any, provided when it was created.<a name='exceptionex_version'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">Version </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Double</span><span style="color: #000000;">  [read only]</span></h5>Returns the version number of the library.<hr/>
<h3><u><a name='lock'>Lock</a></u></h3>
</h5>This is the Lock  object that is a thin wrapper over an Android Semaphore object.
<br/>

<h4>Events:</h4>
None
<h4>Members:</h4><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#lock_initialize'><b>Initialize</b></a> (locked </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#lock_isinitialized'><b>IsInitialized</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#lock_lock'><b>Lock</b></a></span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#lock_lockstate'><b>LockState</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#lock_unlock'><b>Unlock</b></a></span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#lock_version'><b>Version</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Double</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#lock_wait'><b>Wait</b></a></span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#lock_waitfor'><b>WaitFor</b></a> (timeout </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><br/><br/>

<h4>Members description:</h4>
<a name='lock_initialize'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Initialize (locked </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">)</span></h5>Makes a new locked Semaphore, with zero permits, or an unlocked Semaphore<br/>with one permit. A Semaphore initialised unlocked can be used to control<br/>access to a resource. To acquire a resource the sequence for a thread is<br/>Wait() - use resource - UnLock(). A Semaphore initialised locked can be<br/>used to flag events across threads. The sequence is for the waiting thread<br/>to call Wait() and the invoking thread to call Unlock().<a name='lock_isinitialized'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">IsInitialized </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span></h5><a name='lock_lock'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Lock</span></h5>Sets the lock on this Semaphore. Any thread now trying to wait on it<br/>will halt waiting for some other thread to unlock it.<a name='lock_lockstate'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">LockState </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">  [read only]</span></h5>Returns the state of this Lock, True if locked, False otherwise.<br/>Note that in some situations this might become invalid as soon<br/>as it is read if another thread uses this Lock.<a name='lock_unlock'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Unlock</span></h5>Frees the lock allowing one other thread waiting on it to proceed.<br/>If no threads are waiting then the next thread that tries to wait<br/>will proceed immediately setting the lock as it does.<a name='lock_version'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">Version </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Double</span><span style="color: #000000;">  [read only]</span></h5>Returns the version number of the library.<a name='lock_wait'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Wait</span></h5>Causes the calling thread to wait on this lock until it becomes free.<br/>If this is locked then the calling thread will halt until another thread<br/>frees it, the waiting thread will then proceed and the lock is imediately<br/>set again. If it is already unlocked then the thread does not wait but<br/>proceeds immediately setting the lock as it does so.<a name='lock_waitfor'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">WaitFor (timeout </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span></h5>Causes the calling thread to wait on this lock until it becomes free or until<br/>the timeout expires. If the specified waiting time elapses without the lock<br/>becoming free then the value False is returned. If the time is less than or equal<br/>to zero, the method will not wait at all. If this is locked then the calling thread<br/>will halt until another thread frees it or the timeout expires. If during the wait<br/>the lock is freed then the waiting thread  will proceed and and this method returns<br/>True and the lock is immediately set again. If it is already unlocked then the<br/>thread does not wait but proceeds immediately returning True and setting the lock<br/>as it does so.<hr/>
<h3><u><a name='thread'>Thread</a></u></h3>
</h5>This is the Thread object that actually runs a Basic4Android Sub on a separate thread.<br/>Normally Threads should be created as Process objects so they will persist as long as <br/>the application exists. This will make their behaviour easier to predict and control<br/>rather them being Activity objects which will need recreating when an activity resumes<br/>which might leave orphan threads running that could cause unexpected problems.
<br/>

<h4>Events:</h4>
Ended(endedOK As Boolean, error As String) 'The thread has terminated. If endedOK is False error holds the reason for failure<br/>
<h4>Members:</h4><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_error'><b>Error</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #008B8B;"><a href='#thread_exception'><b>Exception</b></a></span><span style="color: #000000;"> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Exception</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_initialise'><b>Initialise</b></a> (eventname </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_interrupt'><b>Interrupt</b></a></span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_isinitialized'><b>IsInitialized</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_isinterrupted'><b>IsInterrupted</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_join'><b>Join</b></a> (mSecs </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_maxpriority'><b>MaxPriority</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_minpriority'><b>MinPriority</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_name'><b>Name</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_normalpriority'><b>NormalPriority</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_priority'><b>Priority</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_running'><b>Running</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_runonguithread'><b>RunOnGuiThread</b></a> (</span><span style="color: #0000FF;">sub As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, params() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Object</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_sleep'><b>Sleep</b></a> (mSecs </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">)</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_start'><b>Start</b></a> (</span><span style="color: #0000FF;">sub As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, args() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Object</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><br/><br/>
<img src='images/19.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_version'><b>Version</b></a> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Double</span><span style="color: #000000;">  [read only]</span><br/><br/>
<img src='images/15.png'/>&nbsp;&nbsp;<span style="color: #000000;"><a href='#thread_yield'><b>Yield</b></a></span><br/><br/>

<h4>Members description:</h4>
<a name='thread_error'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">Error </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span></h5>Because Exceptions in a separate thread are not passed back to the main thread<br/>and can cause the application to hang any Exceptions are trapped in the Thread<br/>object Start method and the Exception message saved in the Error property and<br/>the thread Ended event raised on the main GUI thread. Reading this property<br/>gets the description of any exception caused by the thread code and is the same<br/>string that is passed to the Ended event.<a name='thread_exception'/>
<h5><img src='images/19.png'/>
<span style="color: #008B8B;">Exception</span><span style="color: #000000;"> </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Exception</span></h5>Because Exceptions in a separate thread are not passed back to the main thread<br/>and can cause the application to hang any Exceptions are trapped in the Thread<br/>object Start method and the Exception object saved in the Exception property<br/>and the thread Ended event raised on the main GUI thread. Reading this property<br/>returns  the saved Exception object.<a name='thread_initialise'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Initialise (eventname </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">)</span></h5>Initialises the thread object with the given event name.<a name='thread_interrupt'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Interrupt</span></h5>Posts an interrupt request to this thread. The thread is only interrupted<br/>if the thread is doing I/O or is in a wait-state (having called wait() on<br/>a LockFlag. If the thread is blocked in a join() or sleep() it will be<br/>woken up, its interrupt status will be cleared, and it will receive an<br/>InterruptedException. If the thread is blocked in an I/O operation of an<br/>InterruptibleChannel it will have its interrupt status set and receive a<br/>ClosedByInterruptException and the channel will be closed.<br/>If the thread Sub code is running freely without waiting or blocking and<br/>it knows that it might be expected to stop on an Interrupt then it should<br/>periodically check the IsInterrupted property and exit gracefully if it is True.<br/>Otherwise the recommended way of stopping a thread is for it to inspect<br/>a global variable whose value will tell it to stop or perform some other action.<a name='thread_isinitialized'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">IsInitialized </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span></h5><a name='thread_isinterrupted'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">IsInterrupted </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">  [read only]</span></h5>Returns a boolean indicating whether the thread has a pending interrupt request<br/>(True) or not (False). It also has the side-effect of clearing the flag.<a name='thread_join'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Join (mSecs </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span></h5>Blocks the calling thread until the called thread finishes its execution<br/>and dies or the specified timeout expires, whichever happens first.<br/>Passing a value of zero or less blocks the calling thread until the called<br/>thread finishes its execution and dies.<a name='thread_maxpriority'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">MaxPriority </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span></h5>The maximum priority value allowed for this thread.<a name='thread_minpriority'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">MinPriority </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span></h5>The minimum priority value allowed for a thread.<a name='thread_name'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">Name </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span></h5>Sets or returns the name of the Thread. This name is displayed in DDMS while the<br/>thread is running. The default name for a thread is the event name passed to Initialise.<a name='thread_normalpriority'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">NormalPriority </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">  [read only]</span></h5>The normal (default) priority value assigned to threads.<a name='thread_priority'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">Priority </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span></h5>Sets or returns the priority of the Thread.<a name='thread_running'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">Running </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span><span style="color: #000000;">  [read only]</span></h5>Returns True if the thread has already been started and still runs code<br/>(hasn't died yet). Returns False either if the thread hasn't been started yet<br/>or if it has already started and run to completion and died.<a name='thread_runonguithread'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">RunOnGuiThread (</span><span style="color: #0000FF;">sub As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, params() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Object</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span></h5>Causes the specified Sub to be scheduled for execution on the main GUI thread.<br/>This mechanism is the only way a thread can access GUI items. This call returns<br/>immediately. If it is necessary for the thread to wait for the result of the<br/>GUI operation then it should wait on a Lock that will be reset by the called Sub<br/>after it haas completed the GUI operation. Sometimes it seems that if the user<br/>presses the back button, and maybe in other scenarions, then Android loses the<br/>message and the GUI thread doesn't get it and the Sub isn't run and the Lock<br/>isn't freed so it may be advisable in this case to use WaitFor with a reasonably<br/>long timeout and retry until it returns True.<a name='thread_sleep'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Sleep (mSecs </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Int</span><span style="color: #000000;">)</span></h5>Note that this method affects the caller and not this Thread object.<br/>Causes the thread to sleep for the specified number of milliseconds suspending<br/>the thread before rescheduling it for execution. The precision of the length of<br/>sleep is not guaranteed, the Thread may sleep for more or less time than requested<a name='thread_start'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Start (</span><span style="color: #0000FF;">sub As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">String</span><span style="color: #000000;">, args() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Object</span><span style="color: #000000;">) </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Boolean</span></h5>Starts the new thread of execution. The specified Sub will be called by the newly<br/>started thread and passed the provided parameters. Returns True if the thread was<br/>started, False if the thread is already running and a new one could not be started.<br/>Threads are always started as daemon threads which are threads that will be killed<br/>when the main application thread terminates. Because Exceptions in a separate thread<br/>are not passed back to the main thread and can cause the application to hang any<br/>uncaught Exceptions thrown in the thread Sub are trapped and saved in the threads<br/>Error property. The Thread ends when the thread Sub returns or throws an uncaught Exception.<br/>When the thread terminates, for whatever reason, the Ended event is raised. If the thread<br/>terminated normally then the Ended event endedOK parameter is True otherwise endedOK is<br/>False and the error parameter contains the reason which is the same string returned by<br/>reading the Error property. If a Sub includes a Try - Catch it can always rethrow the<br/>exception using an ExceptionEx object.<a name='thread_version'/>
<h5><img src='images/19.png'/>
<span style="color: #000000;">Version </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #008B8B;">Double</span><span style="color: #000000;">  [read only]</span></h5>Returns the version number of the library.<a name='thread_yield'/>
<h5><img src='images/15.png'/>
<span style="color: #000000;">Yield</span></h5>Note that this method affects the caller and not this Thread object.<br/>This causes the calling thread to sleep for zero milliseconds which has the<br/>effect of suspending the thread and immediately rescheduling it for execution.
<hr/>
<a href="#top">Top</a>
</body>
</html>
